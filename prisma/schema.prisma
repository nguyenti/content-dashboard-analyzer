generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model ContentPost {
  id          String   @id @default(cuid())
  contentId   String   @unique
  title       String
  content     String
  mediaUrls   String   // JSON array as string
  publishedAt DateTime
  
  // Platform info (discriminator)
  platformId   String
  platformType String // 'linkedin' | 'youtube' | 'instagram'
  platformName String
  
  // Platform-specific metrics stored as JSON
  metricsJson String // Serialized LinkedInMetrics | YouTubeMetrics | InstagramMetrics
  
  // Optional script
  scriptId         String?
  scriptSource     String? // 'google_doc' | 'upload'
  scriptTitle      String?
  scriptContent    String?
  scriptUrl        String?
  scriptUploadedAt DateTime?
  
  // Optional AI analysis
  aiAnalysisId     String?
  performanceScore Float?
  strengths        String? // JSON array
  weaknesses       String? // JSON array
  recommendations  String? // JSON array
  
  // Content structure analysis (optional)
  hookEffectiveness     Float?
  storytellingStructure String?
  callToActionPresence  Boolean?
  emotionalTone         String? // JSON array
  keyTopics             String? // JSON array
  readabilityScore      Float?
  visualContentRatio    Float?
  
  // Trend analysis (optional)
  topPerformingElements String? // JSON array
  emergingPatterns      String? // JSON array
  seasonalTrends        String? // JSON array
  audiencePreferences   String? // JSON array
  aiGeneratedAt         DateTime?
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@index([platformType, publishedAt])
  @@index([performanceScore])
}

model Platform {
  id          String   @id @default(cuid())
  type        String   @unique // 'linkedin' | 'youtube' | 'instagram'
  displayName String
  isActive    Boolean  @default(true)
  lastSyncAt  DateTime?
  
  // Platform-specific credentials stored as JSON
  credentialsJson String // Serialized LinkedInPlatform | YouTubePlatform | InstagramPlatform credentials
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model AnalysisPlugin {
  id          String   @id @default(cuid())
  name        String   @unique
  description String
  version     String
  isActive    Boolean  @default(true)
  configJson  String   // Plugin configuration as JSON
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}